version: "3"

services:
  calculator:
    container_name: calculator
    image: stocky-calculator:dev
    restart: always
    command: "uvicorn main:app --reload --host 0.0.0.0 --port 80"
    environment:
      - docker.env
    volumes:
      - /app/node_modules
      - ./calculator:/app

  client:
    container_name: client
    image: stocky-client:dev
    restart: always
    environment:
      - docker.env
    volumes:
      - /app/node_modules
      - ./client:/app
    ports:
      - "3000:3000"

  gateway:
    container_name: gateway
    command: ["npm","run","dev"]
    image: stocky-gateway:dev
    restart: always
    environment:
      - docker.env
    volumes:
      - /app/node_modules
      - ./gateway:/app
    ports:
      - "80:3000"
    
